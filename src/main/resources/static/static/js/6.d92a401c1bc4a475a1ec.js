webpackJsonp([6],{YWuV:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s={data:function(){return{labelWidth:"100px",tableLoading:!1,fullloading:!1,dialogTitle:"",dialogVisible:!1,authorityVisible:!1,buttonauthorityVisible:!1,addbool:!1,keywords:"",roleList:[],role:{id:null,name:"",nameZh:""},idstr:"",props:{label:"menuName",children:"children"},treeData:[],checkedKeys:[],menuButtonList:[],buttonIds:[],button:{id:null,buttonName:""},total:-1,page:1,size:6}},mounted:function(){this.getList()},methods:{getList:function(){var t=this,e=this;this.tableLoading=!0,this.$http.get("/system/role/getAll").then(function(i){t.tableLoading=!1,i&&200==i.status&&(1==i.data.status?(t.authorityVisible=!1,t.buttonauthorityVisible=!1,e.roleList=i.data.data):t.$message.error("查询失败"))}).catch(function(e){"403"==e.response.status&&t.$router.push({path:"/forbidden403"})})},add:function(){this.role={},this.addbool=!0,this.dialogVisible=!0,this.dialogTitle="新增"},update:function(t,e){this.dialogVisible=!0,this.addbool=!1,this.dialogTitle=e.title,this.role=window.clone(t);var i=this.role.name;i=i.startsWith("ROLE_")?i.slice(5):i,this.role.name=i},searchClick:function(){alert("ff")},handleSelectionChange:function(t){var e="";for(var i in t)e+=t[i].id+",";this.idstr=e},handleCheckedButtonChange:function(t){console.log(this.buttonIds.toString())},cancelEidt:function(){this.dialogVisible=!1,this.authorityVisible=!1,this.buttonauthorityVisible=!1},sendMsg:function(){this.addbool?this.postMsg():this.putMsg()},postMsg:function(){var t=this,e=this.role;this.$http({method:"post",url:"/system/role/save",data:e}).then(function(e){var i=e.data;1==i.status?(t.dialogVisible=!1,t.$message({message:"新增成功",type:"success"}),t.getList()):null!=i.msg?t.$message.error(i.msg):t.$message.error("新增失败")}).catch(function(t){console.log(t)})},putMsg:function(){var t=this,e=this.role;this.$http({method:"put",url:"/system/role/update",data:e}).then(function(e){var i=e.data;1==i.status?(t.dialogVisible=!1,t.$message({message:"修改成功",type:"success"}),t.getList()):null!=i.msg?t.$message.error(i.msg):t.$message.error("修改失败")}).catch(function(t){console.log(t)})},deleteMsg:function(t){var e=this,i=this;this.$confirm("确定删除此操作?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){i.$http({method:"delete",url:"/system/role/delete/"+t}).then(function(t){var i=t.data;1==i.status?(e.$message({message:"删除成功",type:"success"}),e.getList()):null!=i.msg?e.$message.error(i.msg):e.$message.error("删除失败")}).catch(function(t){console.log(t)})}).catch(function(){e.$message({type:"info",message:"已取消删除"})})},deleteAll:function(){var t=this.idstr;if(!t)return this.$message.error("提示，您还没有选择任何信息"),!1;this.deleteMsg(t)},setAuthority:function(t,e){this.loadMenu(t),this.authorityVisible=!0,this.dialogTitle=e.title,this.role.id=t},setButtonAuthority:function(t,e){this.buttonauthorityVisible=!0,this.dialogTitle=e.title,this.role.id=t,this.loadButton(t)},loadMenu:function(t){var e=this;this.$http({method:"get",url:"/system/menu/tree/"+t}).then(function(t){var i=t.data;1==i.status&&(e.treeData=i.data.menus,e.checkedKeys=i.data.mids)}).catch(function(t){})},loadButton:function(t){0===this.menuButtonList.length&&this.$http({method:"get",url:"/system/menu/getMenuButtons"}).then(function(t){var i=t.data;1==i.status&&(e.menuButtonList=i.data)}).catch(function(t){});var e=this;this.$http({method:"get",url:"/system/menu/getButtonIdByRoleId/"+t}).then(function(t){var i=t.data;1==i.status&&(e.buttonIds=i.data)}).catch(function(t){})},updateRoleMenu:function(){var t=this,e=this.$qs.stringify({roleId:this.role.id,menuIds:this.$refs.tree.getCheckedKeys(!0).toString()});this.$http({method:"put",url:"/system/role/updateRoleMenu",data:e}).then(function(e){var i=e.data;1==i.status?(t.$message({message:"修改成功",type:"success"}),t.getList()):null!=i.msg?t.$message.error(i.msg):t.$message.error("修改失败")}).catch(function(t){})},updateRoleButton:function(){var t=this,e=this.$qs.stringify({roleId:this.role.id,buttonIds:this.buttonIds.toString()});this.$http({method:"put",url:"/system/role/updateRoleButton",data:e}).then(function(e){var i=e.data;1==i.status?(t.$message({message:"修改成功",type:"success"}),t.getList()):null!=i.msg?t.$message.error(i.msg):t.$message.error("修改失败")}).catch(function(t){})},handleCheckChange:function(t,e,i){}}},a={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{directives:[{name:"loading",rawName:"v-loading",value:t.fullloading,expression:"fullloading"}],staticStyle:{"margin-top":"10px"},attrs:{id:"base"}},[i("div",{staticStyle:{"margin-top":"20px"}},[i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.tableLoading,expression:"tableLoading"}],staticStyle:{width:"100%"},attrs:{data:t.roleList,size:"mini",border:"",stripe:""},on:{"selection-change":t.handleSelectionChange}},[i("el-table-column",{attrs:{type:"selection",align:"left"}}),t._v(" "),i("el-table-column",{attrs:{prop:"nameZh",align:"center",label:"角色"}}),t._v(" "),i("el-table-column",{attrs:{label:"操作",align:"center",width:"400",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[t.$hasButton("roleMenuEdit")?i("el-button",{staticStyle:{padding:"3px 4px 3px 4px",margin:"10px"},attrs:{type:"primary",size:"mini"},on:{click:function(i){t.setAuthority(e.row.id,{title:"菜单权限"})}}},[t._v("菜单权限\n          ")]):t._e(),t._v(" "),t.$hasButton("roleButtonEdit")?i("el-button",{staticStyle:{padding:"3px 4px 3px 4px",margin:"10px"},attrs:{type:"success",size:"mini"},on:{click:function(i){t.setButtonAuthority(e.row.id,{title:"按钮权限"})}}},[t._v("按钮权限\n          ")]):t._e(),t._v(" "),t.$hasButton("roleEdit")?i("el-button",{staticStyle:{padding:"3px 4px 3px 4px",margin:"10px"},attrs:{type:"primary",size:"mini"},on:{click:function(i){t.update(e.row,{title:"修改"})}}},[t._v("修改\n          ")]):t._e(),t._v(" "),t.$hasButton("roleDel")?i("el-button",{staticStyle:{padding:"3px 4px 3px 4px",margin:"10px"},attrs:{type:"danger",size:"mini"},on:{click:function(i){t.deleteMsg(e.row.id)}}},[t._v("删除\n          ")]):t._e()]}}])})],1)],1),t._v(" "),i("div",{staticClass:"clearfix"},[i("div",{staticClass:"fl",staticStyle:{"margin-top":"20px"}},[t.$hasButton("roleAdd")?i("el-button",{attrs:{size:"mini",type:"success",icon:"el-icon-search"},on:{click:t.add}},[t._v("新增")]):t._e(),t._v(" "),t.$hasButton("roleDel")?i("el-button",{attrs:{size:"mini",type:"danger",icon:"el-icon-delete"},on:{click:function(e){t.deleteAll()}}},[t._v("删除")]):t._e()],1)]),t._v(" "),i("el-form",{staticStyle:{margin:"0px",padding:"0px"}},[i("div",{staticStyle:{"text-align":"left"},attrs:{id:"Bdialog"}},[i("el-dialog",{staticStyle:{padding:"0px"},attrs:{"close-on-click-modal":!1,visible:t.dialogVisible,width:"50%"},on:{"update:visible":function(e){t.dialogVisible=e}}},[i("div",{staticClass:"dialog_B Detail"},[i("div",{staticStyle:{width:"700px",margin:"auto"}},[i("h1",{staticClass:"H1"},[t._v(t._s(t.dialogTitle))]),t._v(" "),i("el-form",{staticStyle:{margin:"0px",padding:"0px"}},[i("el-form-item",{attrs:{label:"角色英文名：",prop:"name","label-width":t.labelWidth}},[i("el-input",{attrs:{placeholder:"请输入角色英文名","prefix-icon":"el-icon-edit"},model:{value:t.role.name,callback:function(e){t.$set(t.role,"name",e)},expression:"role.name"}},[i("template",{slot:"prepend"},[t._v("ROLE_")])],2)],1),t._v(" "),i("el-form-item",{attrs:{label:"角色中文名：",prop:"username","label-width":t.labelWidth}},[i("el-input",{attrs:{placeholder:"请输入角色中文名","prefix-icon":"el-icon-edit"},model:{value:t.role.nameZh,callback:function(e){t.$set(t.role,"nameZh",e)},expression:"role.nameZh"}})],1)],1),t._v(" "),i("span",{staticClass:"dialog-footer",staticStyle:{"text-align":"right","margin-top":"20px",width:"100%",display:"block"},attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"small"},on:{click:function(e){t.cancelEidt()}}},[t._v("取 消")]),t._v(" "),i("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(e){t.sendMsg()}}},[t._v("确 定")])],1)],1)])])],1)]),t._v(" "),i("el-form",{staticStyle:{width:"100px"}},[i("div",{staticStyle:{"text-align":"left"}},[i("el-dialog",{staticStyle:{padding:"50px"},attrs:{title:t.dialogTitle,"close-on-click-modal":!1,visible:t.authorityVisible,width:"25%"},on:{"update:visible":function(e){t.authorityVisible=e}}},[i("div",{staticStyle:{"text-align":"center"}},[i("el-tree",{key:t.role.id,ref:"tree",attrs:{props:t.props,data:t.treeData,"default-expanded-keys":t.checkedKeys,"default-checked-keys":t.checkedKeys,"node-key":"id","show-checkbox":"","highlight-current":""},on:{"check-change":t.handleCheckChange}})],1),t._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"mini"},on:{click:t.cancelEidt}},[t._v("取消修改")]),t._v(" "),i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.updateRoleMenu}},[t._v("确认修改")])],1)])],1)]),t._v(" "),i("el-form",{staticStyle:{width:"100px"}},[i("div",{staticStyle:{"text-align":"left"}},[i("el-dialog",{staticStyle:{padding:"50px"},attrs:{title:t.dialogTitle,"close-on-click-modal":!1,visible:t.buttonauthorityVisible,width:"50%"},on:{"update:visible":function(e){t.buttonauthorityVisible=e}}},[i("div",{staticClass:"dialog_B Detail"},[i("div",{staticStyle:{width:"700px",margin:"auto"}},[i("el-table",{staticStyle:{width:"100%"},attrs:{data:t.menuButtonList,size:"mini",border:"",stripe:""}},[i("el-table-column",{attrs:{prop:"menuName",align:"center",label:"所属菜单"}}),t._v(" "),i("el-table-column",{attrs:{align:"center",label:"按钮名称"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-checkbox-group",{on:{change:t.handleCheckedButtonChange},model:{value:t.buttonIds,callback:function(e){t.buttonIds=e},expression:"buttonIds"}},t._l(e.row.buttons,function(e){return i("el-checkbox",{key:e.id,attrs:{label:e.id}},[t._v(t._s(e.buttonName))])}))]}}])})],1),t._v(" "),i("span",{staticClass:"dialog-footer",staticStyle:{"text-align":"right","margin-top":"20px",width:"100%",display:"block"},attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"small"},on:{click:function(e){t.cancelEidt()}}},[t._v("取 消")]),t._v(" "),i("el-button",{attrs:{size:"small",type:"primary"},on:{click:t.updateRoleButton}},[t._v("确 定")])],1)],1)])])],1)])],1)},staticRenderFns:[]};var n=i("VU/8")(s,a,!1,function(t){i("aAXr")},null,null);e.default=n.exports},aAXr:function(t,e){}});
//# sourceMappingURL=6.d92a401c1bc4a475a1ec.js.map